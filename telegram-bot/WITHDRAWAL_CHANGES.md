# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –≤—ã–≤–æ–¥–æ–≤ —Å—Ä–µ–¥—Å—Ç–≤

## –î–∞—Ç–∞: 11 –¥–µ–∫–∞–±—Ä—è 2025

### –í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞ –Ω–∞ –≤—Å–µ –≤—ã–≤–æ–¥—ã**
   - –¢–µ–ø–µ—Ä—å –í–°–ï –≤—ã–≤–æ–¥—ã —Å—Ä–µ–¥—Å—Ç–≤ (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—É–º–º—ã) —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - –†–∞–Ω—å—à–µ –≤—ã–≤–æ–¥—ã –¥–æ $100 –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ OxaPay
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å—Ä–∞–∑—É —Ä–µ–∑–µ—Ä–≤–∏—Ä—É—é—Ç—Å—è (—Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
   - –°—Ç–∞—Ç—É—Å –≤—ã–≤–æ–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `PROCESSING`

2. **IP-–∞–¥—Ä–µ—Å –≤ –∑–∞—è–≤–∫–∞—Ö –Ω–∞ –≤—ã–≤–æ–¥**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `ipAddress` –≤ —Ç–∞–±–ª–∏—Ü—É `Withdrawal` (schema.prisma)
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è IP-–∞–¥—Ä–µ—Å, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª —Å–¥–µ–ª–∞–Ω –∑–∞–ø—Ä–æ—Å
   - IP-–∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏: `x-forwarded-for`, `x-real-ip`, –∞ —Ç–∞–∫–∂–µ `req.ip` –∏ `req.socket.remoteAddress`

### –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã:

1. **telegram-bot/prisma/schema.prisma**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `ipAddress String?` –≤ –º–æ–¥–µ–ª—å `Withdrawal`

2. **telegram-bot/src/api.ts** (—ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/user/:telegramId/create-withdrawal`)
   - –£–¥–∞–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–≤–æ–¥–æ–≤ –¥–æ $100
   - –í—Å–µ –≤—ã–≤–æ–¥—ã —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –æ –≤—ã–≤–æ–¥–µ
   - IP-–∞–¥—Ä–µ—Å –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É

### –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏:

**telegram-bot/add-ipaddress-to-withdrawal.cjs**
- –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `ipAddress` –≤ —Ç–∞–±–ª–∏—Ü—É `Withdrawal`

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é:

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
   ```bash
   cd telegram-bot
   node add-ipaddress-to-withdrawal.cjs
   ```

2. –û–±–Ω–æ–≤–∏—Ç—å Prisma Client:
   ```bash
   npx prisma generate
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ API-—Å–µ—Ä–≤–µ—Ä

### –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É:

```
üîî Withdrawal Request - Requires Approval

üë§ User: @username (ID: 123456789)
üí∞ Amount: $50.00
üíé Currency: USDT
üåê Network: TRC20
üìç Address: `TXxx...xxx`
üåç IP Address: 192.168.1.1

üí≥ Previous Deposit: $100.00
üí≥ New Deposit: $50.00
‚úÖ Funds have been reserved

üÜî Withdrawal ID: 42
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- **–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤**: –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å—Ä–∞–∑—É —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–ø–∏—Å–∞–Ω–∏—è**: –°–Ω–∞—á–∞–ª–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è profit, –∑–∞—Ç–µ–º totalDeposit
- **–í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤**: –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–∞ —Å—á—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **IP-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—Å–∫–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IP –∑–∞ –ø—Ä–æ–∫—Å–∏/–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞–º–∏
